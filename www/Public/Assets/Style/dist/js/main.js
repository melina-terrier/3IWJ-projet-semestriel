(function(c){typeof define=="function"&&define.amd?define(c):c()})(function(){"use strict";window.onload=()=>{document.querySelectorAll(".navbar__toggle").forEach(c=>{c.addEventListener("click",d=>{console.log("click");const o=d.target;o.classList.toggle("active");const r=o.closest(".navbar");r.classList.toggle("toggled");const s=r.querySelector(".navbar__toggle-content");r.classList.contains("toggled")?s.style.maxHeight=s.scrollHeight+"px":s.style.maxHeight="0"})})},document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("add-to-menu"),d=document.getElementById("add-external-link"),o=document.querySelector(".menu-list"),r=document.querySelector('[type="submit"]');c.addEventListener("click",e=>{e.preventDefault(),document.querySelectorAll('input[type="checkbox"]:checked').forEach(t=>{const n=document.querySelector(`label[for='${t.id}']`);if(n){const u=s(n.textContent,t.id,"page");o.appendChild(u)}})}),d.addEventListener("click",e=>{e.preventDefault();const a=document.getElementById("external-link-title").value,t=document.getElementById("external-link-url").value;if(a&&t){const n=s(a,t,"external_link");o.appendChild(n)}}),r.addEventListener("click",e=>{e.preventDefault();const a=Array.from(o.children).map(t=>({id:t.dataset.checkboxId,type:t.dataset.type,title:t.textContent.replace("Supprimer","").trim(),url:t.dataset.type==="external_link"?t.dataset.url:null}));p(a)});function s(e,a,t){const n=document.createElement("div");n.className="menu-item",n.textContent=e,n.dataset.checkboxId=a,n.dataset.type=t,t==="external_link"&&(n.dataset.url=a);const u=document.createElement("button");return u.textContent="Supprimer",u.addEventListener("click",()=>{o.removeChild(n)}),n.appendChild(u),n.draggable=!0,n.addEventListener("dragstart",i),n.addEventListener("dragover",l),n.addEventListener("drop",m),n}function i(e){e.dataTransfer.setData("text/plain",e.target.dataset.checkboxId),e.dataTransfer.effectAllowed="move",this.style.opacity="0.4"}function l(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function m(e){e.preventDefault(),e.stopPropagation();const a=e.dataTransfer.getData("text/plain"),t=[...o.children].find(n=>n.dataset.checkboxId===a);t&&t!==this&&o.insertBefore(t,this),t.style.opacity="1.0"}function p(e){console.log(e),fetch("/dashboard/menu",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"setMenu",menuItems:e})}).then(a=>a.json()).then(a=>{a.success?alert("Menu sauvegardé avec succès!"):alert("Une erreur est survenue: "+a.errors.join(", "))}).catch(a=>{console.error("Error saving menu:",a),alert("Une erreur est survenue lors de la sauvegarde du menu.")})}}),document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("add-link"),d=c.getAttribute("data-link"),o=document.getElementById(d);let r=1;c.addEventListener("click",s=>{s.preventDefault();const i=document.createElement("input");i.type="text",i.id=d+r,i.name=d,console.log(i),o.appendChild(i),console.log(o),r++})}),document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("openMediaModal"),d=document.getElementById("mediaModal"),o=document.querySelector(".close"),r=document.getElementById("saveMedia");c.addEventListener("click",l=>{l.preventDefault(),d.style.display="block"}),o.addEventListener("click",l=>{l.preventDefault,d.style.display="none"}),window.addEventListener("click",l=>{l.preventDefault,l.target===d&&(d.style.display="none")}),r.addEventListener("click",l=>{l.preventDefault}),d.querySelector('[type="submit"]').addEventListener("click",i);function i(l){l.preventDefault()}})});
